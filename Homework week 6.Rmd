---
title: "Week 6 Homework"
author: "Brandon Güell"
date: "10/19/2017"
output: html_document
---

1: Write a simple R function, Z.prop.test(), that can perform one- or two-sample Z-tests for proportion data, using the following guidelines

```{r}
z.prop.test <- function(p1, n1, p2 = NULL, n2 = NULL, p0, alternative = c("two.sided", "less", "greater"), conf.level =0.95)
{
  
  OK <- complete.cases(p1, n1, p0)
    p1 <- p1[OK]
    n1 <- n1[OK]
    p0 <- p0[OK]
 
    
    if (n1*p1 < 5)
	warning("assumption is not met")
    if (n1 * (1-p1) < 5)
  warning("assumption is not met")
    
    
    if (is.null(c(p2,n2))) {
	  z <- (p1-p0)/sqrt((p0 * (1-p0)/n1))
    lower <- p1 - qnorm(0.975) * sqrt(p1 * (1 - p1)/n1)
    upper <- p1 + qnorm(0.975) * sqrt(p1 * (1 - p1)/n1)
    ci <- c(lower, upper)
    
        if (alternative == "less") {
            p <- pnorm(z, lower.tail = TRUE)
        }
        if (alternative == "greater") {
            p <- pnorm(z, lower.tail = FALSE)
        }
        if (alternative == "two.sided") {
            if (z > 0) 
                {
                  p <- 2 * pnorm(z, lower.tail = FALSE)
                } 
            if (z < 0) 
                {
                  p <- 2 * pnorm(z, lower.tail = TRUE)
                }  

        }
    }
    
    #SECOND PART STARTS HERE FOR TWO-SAMPLE
   else  {
     pstar= p1+p2
     pci= p2-p1
     ntot= n1 + n2
	  z <- (p2 - p1)/sqrt((pstar * (1 - pstar)) * (1/n1) + 1/n2)
	  
    lower <- pci - qnorm(0.975) * sqrt(pci * (1 - pci)/ntot)
    upper <- pci + qnorm(0.975) * sqrt(pci * (1 - pci)/ntot)
    ci <- c(lower, upper)
    
        if (alternative == "less") {
            p <- pnorm(z, lower.tail = TRUE)
        }
        if (alternative == "greater") {
            p <- pnorm(z, lower.tail = FALSE)
        }
        if (alternative == "two.sided") {
            if (z > 0) 
                {
                  p <- 2 * pnorm(z, lower.tail = FALSE)
                } 
            if (z < 0) 
                {
                  p <- 2 * pnorm(z, lower.tail = TRUE)
                }  

        }
    }
    
	  
	  
  spitout <- list(statistic = z,
		 p.value = p,
		 conf.int = ci,
		 alternative = alternative)
  
    return(spitout)
  }
```




2: The dataset from Kamilar and Cooper has in it a large number of variables related to life history and body size. For this exercise, the end aim is to fit a simple linear regression model to predict longevity (MaxLongevity_m) measured in months from species’ brain size (Brain_Size_Species_Mean) measured in grams. Do the following for both  longevity~brain size and  log(longevity)~log(brain size).

First for longevity~brain size

```{r}
lm
```

